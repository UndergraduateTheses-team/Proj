name: SonarQube Scan

on:
  workflow_dispatch:
  # push:
  #   branches:
  #     - main
  # pull_request:
  #   types: [opened, synchronize, reopened]
jobs:
  sonarqube:
    name: SonarQube
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis
      - name: SonarQube Scan
        uses: SonarSource/sonarqube-scan-action@v5
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}

  # send-logs-to-elastic:
  #   runs-on: ubuntu-latest
  #   if: always()
  #   steps:
  #     - name: Upload GitHub Action workflows logs to elastic
  #       uses: knutfr/github-actions-to-elk@v1.0.4
  #       with:
  #         githubToken: "${{ secrets.GITHUB }}"
  #         githubOrg: "UndergraduteTheses-team"
  #         githubRepository: "Proj"
  #         githubRunId: "${{ github.run_id }}"
  #         elasticHost: "${{ secrets.ELASTIC_HOST }}"
  #         elasticApiKeyId: "${{ secrets.ELASTIC_KEY_ID }}"
  #         elasticApiKey: "${{ secrets.ELASTIC_API_KEY }}"
  #         elasticIndex: "github"